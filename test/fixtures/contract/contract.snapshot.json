{
  "name": "zcl",
  "version": "0.0.0-dev",
  "artifactLayoutVersion": 1,
  "traceSchemaVersion": 1,
  "artifacts": [
    {
      "id": "run.json",
      "kind": "json",
      "schemaVersions": [
        1
      ],
      "required": true,
      "pathPattern": ".zcl/runs/<runId>/run.json",
      "requiredFields": [
        "schemaVersion",
        "artifactLayoutVersion",
        "runId",
        "suiteId",
        "createdAt"
      ]
    },
    {
      "id": "suite.json",
      "kind": "json",
      "schemaVersions": [
        1
      ],
      "required": false,
      "pathPattern": ".zcl/runs/<runId>/suite.json",
      "requiredFields": []
    },
    {
      "id": "suite.run.summary.json",
      "kind": "json",
      "schemaVersions": [
        1
      ],
      "required": false,
      "pathPattern": ".zcl/runs/<runId>/suite.run.summary.json",
      "requiredFields": [
        "schemaVersion",
        "runId",
        "suiteId",
        "mode",
        "sessionIsolationRequested",
        "sessionIsolation",
        "attempts",
        "passed",
        "failed",
        "createdAt"
      ]
    },
    {
      "id": "run.report.json",
      "kind": "json",
      "schemaVersions": [
        1
      ],
      "required": false,
      "pathPattern": ".zcl/runs/<runId>/run.report.json",
      "requiredFields": [
        "schemaVersion",
        "target",
        "runId",
        "suiteId",
        "path",
        "attempts",
        "aggregate"
      ]
    },
    {
      "id": "campaign.state.json",
      "kind": "json",
      "schemaVersions": [
        1
      ],
      "required": false,
      "pathPattern": ".zcl/campaigns/<campaignId>/campaign.state.json",
      "requiredFields": [
        "schemaVersion",
        "campaignId",
        "suiteId",
        "updatedAt",
        "latestRunId",
        "runs"
      ]
    },
    {
      "id": "campaign.run.state.json",
      "kind": "json",
      "schemaVersions": [
        1
      ],
      "required": false,
      "pathPattern": ".zcl/campaigns/<campaignId>/campaign.run.state.json",
      "requiredFields": [
        "schemaVersion",
        "campaignId",
        "runId",
        "status",
        "updatedAt",
        "totalMissions",
        "missionsCompleted"
      ]
    },
    {
      "id": "campaign.plan.json",
      "kind": "json",
      "schemaVersions": [
        1
      ],
      "required": false,
      "pathPattern": ".zcl/campaigns/<campaignId>/campaign.plan.json",
      "requiredFields": [
        "schemaVersion",
        "campaignId",
        "specPath",
        "missions",
        "createdAt",
        "updatedAt"
      ]
    },
    {
      "id": "campaign.progress.jsonl",
      "kind": "jsonl",
      "schemaVersions": [
        1
      ],
      "required": false,
      "pathPattern": ".zcl/campaigns/<campaignId>/campaign.progress.jsonl",
      "requiredFields": []
    },
    {
      "id": "campaign.report.json",
      "kind": "json",
      "schemaVersions": [
        1
      ],
      "required": false,
      "pathPattern": ".zcl/campaigns/<campaignId>/campaign.report.json",
      "requiredFields": [
        "schemaVersion",
        "campaignId",
        "runId",
        "status",
        "totalMissions",
        "missionsCompleted",
        "gatesPassed",
        "gatesFailed"
      ]
    },
    {
      "id": "campaign.summary.json",
      "kind": "json",
      "schemaVersions": [
        1
      ],
      "required": false,
      "pathPattern": ".zcl/campaigns/<campaignId>/campaign.summary.json",
      "requiredFields": [
        "schemaVersion",
        "campaignId",
        "runId",
        "status",
        "totalMissions",
        "missionsCompleted",
        "gatesPassed",
        "gatesFailed",
        "claimedMissionsOk",
        "verifiedMissionsOk",
        "mismatchCount",
        "evidencePaths"
      ]
    },
    {
      "id": "RESULTS.md",
      "kind": "text",
      "schemaVersions": [
        1
      ],
      "required": false,
      "pathPattern": ".zcl/campaigns/<campaignId>/RESULTS.md",
      "requiredFields": []
    },
    {
      "id": "mission.prompts.json",
      "kind": "json",
      "schemaVersions": [
        1
      ],
      "required": false,
      "pathPattern": ".zcl/campaigns/<campaignId>/mission.prompts.json",
      "requiredFields": [
        "schemaVersion",
        "campaignId",
        "specPath",
        "templatePath",
        "outPath",
        "createdAt",
        "prompts"
      ]
    },
    {
      "id": "attempt.json",
      "kind": "json",
      "schemaVersions": [
        1
      ],
      "required": true,
      "pathPattern": ".zcl/runs/<runId>/attempts/<attemptId>/attempt.json",
      "requiredFields": [
        "schemaVersion",
        "runId",
        "suiteId",
        "missionId",
        "attemptId",
        "mode",
        "startedAt"
      ]
    },
    {
      "id": "prompt.txt",
      "kind": "text",
      "schemaVersions": [
        1
      ],
      "required": false,
      "pathPattern": ".zcl/runs/<runId>/attempts/<attemptId>/prompt.txt",
      "requiredFields": []
    },
    {
      "id": "attempt.env.sh",
      "kind": "text",
      "schemaVersions": [
        1
      ],
      "required": false,
      "pathPattern": ".zcl/runs/<runId>/attempts/<attemptId>/attempt.env.sh",
      "requiredFields": []
    },
    {
      "id": "tool.calls.jsonl",
      "kind": "jsonl",
      "schemaVersions": [
        1
      ],
      "required": false,
      "requiredInModes": [
        "discovery",
        "ci"
      ],
      "pathPattern": ".zcl/runs/<runId>/attempts/<attemptId>/tool.calls.jsonl",
      "requiredFields": []
    },
    {
      "id": "feedback.json",
      "kind": "json",
      "schemaVersions": [
        1
      ],
      "required": false,
      "requiredInModes": [
        "discovery",
        "ci"
      ],
      "pathPattern": ".zcl/runs/<runId>/attempts/<attemptId>/feedback.json",
      "requiredFields": [
        "schemaVersion",
        "runId",
        "suiteId",
        "missionId",
        "attemptId",
        "ok",
        "createdAt"
      ]
    },
    {
      "id": "notes.jsonl",
      "kind": "jsonl",
      "schemaVersions": [
        1
      ],
      "required": false,
      "pathPattern": ".zcl/runs/<runId>/attempts/<attemptId>/notes.jsonl",
      "requiredFields": []
    },
    {
      "id": "captures.jsonl",
      "kind": "jsonl",
      "schemaVersions": [
        1
      ],
      "required": false,
      "pathPattern": ".zcl/runs/<runId>/attempts/<attemptId>/captures.jsonl",
      "requiredFields": []
    },
    {
      "id": "attempt.report.json",
      "kind": "json",
      "schemaVersions": [
        1
      ],
      "required": false,
      "pathPattern": ".zcl/runs/<runId>/attempts/<attemptId>/attempt.report.json",
      "requiredFields": [
        "schemaVersion",
        "runId",
        "suiteId",
        "missionId",
        "attemptId",
        "computedAt",
        "metrics",
        "artifacts"
      ]
    },
    {
      "id": "runner.ref.json",
      "kind": "json",
      "schemaVersions": [
        1
      ],
      "required": false,
      "pathPattern": ".zcl/runs/<runId>/attempts/<attemptId>/runner.ref.json",
      "requiredFields": [
        "schemaVersion",
        "runner",
        "runId",
        "suiteId",
        "missionId",
        "attemptId"
      ]
    },
    {
      "id": "runner.metrics.json",
      "kind": "json",
      "schemaVersions": [
        1
      ],
      "required": false,
      "pathPattern": ".zcl/runs/<runId>/attempts/<attemptId>/runner.metrics.json",
      "requiredFields": [
        "schemaVersion",
        "runner"
      ]
    }
  ],
  "events": [
    {
      "stream": "tool.calls.jsonl",
      "schemaVersions": [
        1
      ],
      "requiredFields": [
        "v",
        "ts",
        "runId",
        "missionId",
        "attemptId",
        "tool",
        "op",
        "result",
        "io"
      ]
    },
    {
      "stream": "notes.jsonl",
      "schemaVersions": [
        1
      ],
      "requiredFields": [
        "v",
        "ts",
        "runId",
        "missionId",
        "attemptId",
        "kind"
      ]
    },
    {
      "stream": "captures.jsonl",
      "schemaVersions": [
        1
      ],
      "requiredFields": [
        "v",
        "ts",
        "runId",
        "missionId",
        "attemptId",
        "tool",
        "op",
        "maxBytes"
      ]
    }
  ],
  "commands": [
    {
      "id": "init",
      "usage": "zcl init [--out-root .zcl] [--config zcl.config.json] [--json]",
      "summary": "Initialize the project output root and write the minimal project config."
    },
    {
      "id": "update status",
      "usage": "zcl update status [--cached] [--json]",
      "summary": "Check latest release status (manual update policy; no runtime auto-update)."
    },
    {
      "id": "feedback",
      "usage": "zcl feedback --ok|--fail --result <string>|--result-json <json> [--classification <...>] [--decision-tag <tag>] [--decision-tags <csv>]",
      "summary": "Write the canonical attempt outcome to feedback.json (primary evidence)."
    },
    {
      "id": "note",
      "usage": "zcl note [--kind agent|operator|system] --message <string>|--data-json <json>",
      "summary": "Append a bounded/redacted note event to notes.jsonl (secondary evidence)."
    },
    {
      "id": "report",
      "usage": "zcl report [--strict] [--json] <attemptDir|runDir>",
      "summary": "Compute attempt.report.json from tool.calls.jsonl + feedback.json."
    },
    {
      "id": "validate",
      "usage": "zcl validate [--strict] [--semantic] [--semantic-rules <path>] [--json] <attemptDir|runDir>",
      "summary": "Validate artifact integrity and optional semantic mission validity with typed error codes."
    },
    {
      "id": "doctor",
      "usage": "zcl doctor [--out-root .zcl] [--json]",
      "summary": "Check environment/config sanity (write access, config parse, optional runner availability)."
    },
    {
      "id": "gc",
      "usage": "zcl gc [--out-root .zcl] [--max-age-days 30] [--max-total-bytes 0] [--dry-run] [--json]",
      "summary": "Retention cleanup under .zcl/runs (age/size; respects pinned runs)."
    },
    {
      "id": "pin",
      "usage": "zcl pin --run-id <runId> --on|--off [--out-root .zcl] [--json]",
      "summary": "Pin/unpin a run (toggles run.json.pinned) so gc will keep it."
    },
    {
      "id": "enrich",
      "usage": "zcl enrich --runner codex|claude --rollout <rollout.jsonl> [<attemptDir>]",
      "summary": "Optional runner enrichment (writes runner.ref.json + runner.metrics.json)."
    },
    {
      "id": "mcp proxy",
      "usage": "zcl mcp proxy [--max-tool-calls N] [--idle-timeout-ms N] [--shutdown-on-complete] [--sequential] -- <server-cmd> [args...]",
      "summary": "MCP stdio proxy funnel with lifecycle controls (records initialize/tools/list/tools/call)."
    },
    {
      "id": "http proxy",
      "usage": "zcl http proxy --upstream <url> [--listen 127.0.0.1:0] [--max-requests N] [--json]",
      "summary": "HTTP reverse proxy funnel (records inbound requests/responses as tool=http op=request)."
    },
    {
      "id": "run",
      "usage": "zcl run [--capture [--capture-raw] --capture-max-bytes N] -- <cmd> [args...]",
      "summary": "Run a command through the ZCL CLI funnel (default passthrough; bounded trace capture; optional full capture + JSON envelope)."
    },
    {
      "id": "contract",
      "usage": "zcl contract --json",
      "summary": "Print the ZCL surface contract (artifact layout + supported schema versions)."
    },
    {
      "id": "attempt start",
      "usage": "zcl attempt start --suite <suiteId> --mission <missionId> [--prompt <text>] [--suite-file <path>] [--run-id <runId>] [--agent-id <id>] [--isolation-model process_runner|native_spawn] [--mode discovery|ci] [--timeout-ms N] [--timeout-start attempt_start|first_tool_call] [--blind] [--blind-terms <csv>] [--out-root .zcl] [--retry 1] [--env-file <path>] [--env-format sh|dotenv] [--print-env sh|dotenv] --json",
      "summary": "Allocate a run/attempt directory and print canonical IDs + env for a fresh session attempt."
    },
    {
      "id": "attempt env",
      "usage": "zcl attempt env [--format sh|dotenv] [--json] [<attemptDir>]",
      "summary": "Print canonical attempt env (uses ZCL_OUT_DIR when <attemptDir> is omitted)."
    },
    {
      "id": "attempt finish",
      "usage": "zcl attempt finish [--strict] [--strict-expect] [--json] [<attemptDir>]",
      "summary": "Write attempt.report.json, then run validate + expect (uses ZCL_OUT_DIR when <attemptDir> is omitted)."
    },
    {
      "id": "attempt explain",
      "usage": "zcl attempt explain [--strict] [--json] [--tail N] [<attemptDir>]",
      "summary": "Fast post-mortem view: show ids/outcome, validate/expect status, and a tail of tool.calls.jsonl (uses ZCL_OUT_DIR when <attemptDir> is omitted)."
    },
    {
      "id": "attempt list",
      "usage": "zcl attempt list [--out-root .zcl] [--suite <suiteId>] [--mission <missionId>] [--status any|ok|fail|missing_feedback] [--tag <tag>] [--limit N] --json",
      "summary": "List attempts as machine-readable index rows with optional suite/mission/status/tag filters."
    },
    {
      "id": "attempt latest",
      "usage": "zcl attempt latest [--out-root .zcl] [--suite <suiteId>] [--mission <missionId>] [--status any|ok|fail|missing_feedback] [--tag <tag>] --json",
      "summary": "Return the latest attempt row matching filters (or found=false)."
    },
    {
      "id": "runs list",
      "usage": "zcl runs list [--out-root .zcl] [--suite <suiteId>] [--status any|ok|fail|missing_feedback] [--limit N] --json",
      "summary": "List run-level machine-readable index rows with aggregate attempt status counts."
    },
    {
      "id": "suite plan",
      "usage": "zcl suite plan --file <suite.(yaml|yml|json)> [--run-id <runId>] [--mode discovery|ci] [--timeout-ms N] [--timeout-start attempt_start|first_tool_call] [--blind on|off] [--blind-terms <csv>] [--out-root .zcl] --json",
      "summary": "Allocate attempt dirs for every mission in a suite file and print env/pointers per mission (for orchestrators)."
    },
    {
      "id": "suite run",
      "usage": "zcl suite run --file <suite.(yaml|yml|json)> [--run-id <runId>] [--mode discovery|ci] [--timeout-ms N] [--timeout-start attempt_start|first_tool_call] [--feedback-policy strict|auto_fail] [--finalization-mode strict|auto_fail|auto_from_result_json] [--result-channel none|file_json|stdout_json] [--result-file <attempt-relative-path>] [--result-marker <prefix>] [--result-min-turn N] [--campaign-id <id>] [--campaign-state <path>] [--progress-jsonl <path|->] [--blind on|off] [--blind-terms <csv>] [--session-isolation auto|process|native] [--parallel N] [--total M] [--mission-offset N] [--out-root .zcl] [--strict] [--strict-expect] [--shim <bin>] [--capture-runner-io] --json -- <runner-cmd> [args...]",
      "summary": "Run a suite with capability-aware isolation, optional campaign continuity/progress stream, and deterministic finish/validate/expect per attempt."
    },
    {
      "id": "campaign run",
      "usage": "zcl campaign run --spec <campaign.(yaml|yml|json)> [--out-root .zcl] [--missions N] [--mission-offset N] [--json]",
      "summary": "Run a first-class campaign across configured flows with pair/semantic/timeout/artifact gates."
    },
    {
      "id": "campaign lint",
      "usage": "zcl campaign lint --spec <campaign.(yaml|yml|json)> [--out-root .zcl] [--json]",
      "summary": "Validate campaign spec shape (strict unknown-field rejection) and print resolved mission selection/runtime defaults."
    },
    {
      "id": "campaign canary",
      "usage": "zcl campaign canary --spec <campaign.(yaml|yml|json)> [--out-root .zcl] [--missions N] [--mission-offset N] [--json]",
      "summary": "Run a bounded canary mission window before full campaign execution."
    },
    {
      "id": "campaign resume",
      "usage": "zcl campaign resume --campaign-id <id> [--out-root .zcl] [--json]",
      "summary": "Resume remaining missions from campaign.run.state.json continuity."
    },
    {
      "id": "campaign status",
      "usage": "zcl campaign status --campaign-id <id> [--out-root .zcl] [--json]",
      "summary": "Read the latest first-class campaign execution state."
    },
    {
      "id": "campaign report",
      "usage": "zcl campaign report [--campaign-id <id> | --spec <campaign.(yaml|yml|json)>] [--out-root .zcl] [--format json,md] [--force] [--json]",
      "summary": "Export campaign aggregate reports with invalid-run publication guards."
    },
    {
      "id": "campaign publish-check",
      "usage": "zcl campaign publish-check [--campaign-id <id> | --spec <campaign.(yaml|yml|json)>] [--out-root .zcl] [--force] [--json]",
      "summary": "Refuse publish-ready benchmark output unless campaign status is valid (unless forced)."
    },
    {
      "id": "campaign doctor",
      "usage": "zcl campaign doctor --spec <campaign.(yaml|yml|json)> [--out-root .zcl] [--json]",
      "summary": "Preflight campaign execution prerequisites (runner commands, script binaries, outRoot write access, lock state)."
    },
    {
      "id": "mission prompts build",
      "usage": "zcl mission prompts build --spec <campaign.(yaml|yml|json)> --template <template.txt|md> [--out <path>] [--out-root .zcl] [--json]",
      "summary": "Deterministically materialize mission prompts from campaign spec + template."
    },
    {
      "id": "replay",
      "usage": "zcl replay [--execute] [--allow <cmd1,cmd2>] [--allow-all] [--max-steps N] [--stdin] --json <attemptDir>",
      "summary": "Best-effort replay of tool.calls.jsonl to reproduce failures (partial support by tool/op)."
    },
    {
      "id": "expect",
      "usage": "zcl expect [--strict] --json <attemptDir|runDir>",
      "summary": "Evaluate suite expectations against feedback.json (JSON output includes failures; exit code indicates pass/fail)."
    }
  ],
  "errors": [
    {
      "code": "ZCL_E_USAGE",
      "summary": "Invalid CLI usage (missing/invalid flags).",
      "retryable": false
    },
    {
      "code": "ZCL_E_IO",
      "summary": "Filesystem I/O error while writing artifacts.",
      "retryable": true
    },
    {
      "code": "ZCL_E_MISSING_ARTIFACT",
      "summary": "Missing required artifact(s) for the requested operation.",
      "retryable": true
    },
    {
      "code": "ZCL_E_MISSING_EVIDENCE",
      "summary": "Primary evidence is missing/empty (e.g. empty tool.calls.jsonl).",
      "retryable": true
    },
    {
      "code": "ZCL_E_INVALID_JSON",
      "summary": "Invalid JSON in an artifact file.",
      "retryable": false
    },
    {
      "code": "ZCL_E_INVALID_JSONL",
      "summary": "Invalid JSONL stream (bad line or empty line in strict mode).",
      "retryable": false
    },
    {
      "code": "ZCL_E_SCHEMA_UNSUPPORTED",
      "summary": "Unsupported schema version for an artifact/event.",
      "retryable": false
    },
    {
      "code": "ZCL_E_ID_MISMATCH",
      "summary": "IDs in artifacts/events do not match expected attempt/run IDs.",
      "retryable": false
    },
    {
      "code": "ZCL_E_BOUNDS",
      "summary": "Captured payload exceeds size bounds.",
      "retryable": false
    },
    {
      "code": "ZCL_E_UNSAFE_EVIDENCE",
      "summary": "Evidence violates safety policy (for example raw captures in strict CI mode).",
      "retryable": false
    },
    {
      "code": "ZCL_E_CONTRACT",
      "summary": "Artifact/event violates the ZCL contract shape.",
      "retryable": false
    },
    {
      "code": "ZCL_E_CONTAINMENT",
      "summary": "Artifact path escapes attempt/run directory (symlink traversal).",
      "retryable": false
    },
    {
      "code": "ZCL_E_SPAWN",
      "summary": "Failed to spawn or execute a wrapped command in the funnel.",
      "retryable": true
    },
    {
      "code": "ZCL_E_TOOL_FAILED",
      "summary": "Wrapped tool execution completed with a non-zero outcome.",
      "retryable": true
    },
    {
      "code": "ZCL_E_TIMEOUT",
      "summary": "Timed out waiting for a tool operation.",
      "retryable": true
    },
    {
      "code": "ZCL_E_MCP_MAX_TOOL_CALLS",
      "summary": "MCP proxy stopped after configured max tool calls.",
      "retryable": true
    },
    {
      "code": "ZCL_E_CONTAMINATED_PROMPT",
      "summary": "Blind mode rejected a prompt containing harness terms.",
      "retryable": false
    },
    {
      "code": "ZCL_E_VERSION_FLOOR",
      "summary": "Installed zcl version does not satisfy required minimum version.",
      "retryable": false
    },
    {
      "code": "ZCL_E_FUNNEL_BYPASS",
      "summary": "Primary evidence missing/empty despite a final outcome being recorded (funnel bypass suspected).",
      "retryable": false
    },
    {
      "code": "ZCL_E_EXPECTATION_FAILED",
      "summary": "Suite expectations did not match feedback.json.",
      "retryable": false
    },
    {
      "code": "ZCL_E_SEMANTIC",
      "summary": "Semantic mission validation failed.",
      "retryable": false
    },
    {
      "code": "ZCL_E_MISSION_RESULT_MISSING",
      "summary": "Auto finalization could not find mission result payload on the configured result channel.",
      "retryable": true
    },
    {
      "code": "ZCL_E_MISSION_RESULT_INVALID",
      "summary": "Mission result payload is malformed or does not satisfy required fields.",
      "retryable": false
    },
    {
      "code": "ZCL_E_MISSION_RESULT_TURN_TOO_EARLY",
      "summary": "Mission result payload turn is below configured minimum finalizable turn.",
      "retryable": true
    },
    {
      "code": "ZCL_E_CAMPAIGN_GATE_FAILED",
      "summary": "Campaign pair gate failed for one or more missions.",
      "retryable": false
    },
    {
      "code": "ZCL_E_CAMPAIGN_FIRST_MISSION_GATE_FAILED",
      "summary": "Campaign first mission canary/pair gate failed.",
      "retryable": false
    },
    {
      "code": "ZCL_E_CAMPAIGN_PROMPT_MODE_VIOLATION",
      "summary": "Campaign mission-only prompt policy violation (harness term leakage).",
      "retryable": false
    },
    {
      "code": "ZCL_E_CAMPAIGN_TOOL_DRIVER_SHIM_REQUIRED",
      "summary": "Campaign flow with toolDriver.kind=cli_funnel is missing required shims.",
      "retryable": false
    },
    {
      "code": "ZCL_E_CAMPAIGN_LOCK_TIMEOUT",
      "summary": "Campaign lock acquisition failed (another campaign run/resume likely owns the lock).",
      "retryable": true
    }
  ],
  "campaignSchema": {
    "schemaVersion": 1,
    "specSchemaPath": "internal/campaign/campaign.spec.schema.json",
    "traceProfiles": [
      "none",
      "strict_browser_comparison",
      "mcp_required"
    ],
    "runnerTypes": [
      "process_cmd",
      "codex_exec",
      "codex_subagent",
      "claude_subagent"
    ],
    "toolDriverKinds": [
      "shell",
      "cli_funnel",
      "mcp_proxy",
      "http_proxy"
    ],
    "finalizationModes": [
      "strict",
      "auto_fail",
      "auto_from_result_json"
    ],
    "resultChannelKinds": [
      "none",
      "file_json",
      "stdout_json"
    ],
    "defaults": {
      "promptMode": "default",
      "forbiddenPromptTerms": [
        "zcl run",
        "zcl mcp proxy",
        "zcl http proxy",
        "zcl feedback",
        "zcl attempt finish",
        "tool.calls.jsonl",
        "feedback.json"
      ],
      "flowMode": "sequence",
      "traceProfile": "none",
      "toolDriverKind": "shell",
      "finalizationMode": "auto_fail",
      "resultChannelKind": "none",
      "resultChannelPath": "mission.result.json",
      "resultChannelMarker": "ZCL_RESULT_JSON:",
      "resultMinTurn": 1,
      "freshAgentPerAttempt": true,
      "adapterRequiredOutputFields": [
        "attemptDir",
        "status",
        "errors"
      ]
    },
    "policyErrorCodes": [
      "ZCL_E_CAMPAIGN_PROMPT_MODE_VIOLATION",
      "ZCL_E_CAMPAIGN_TOOL_DRIVER_SHIM_REQUIRED",
      "ZCL_E_CAMPAIGN_GATE_FAILED",
      "ZCL_E_CAMPAIGN_FIRST_MISSION_GATE_FAILED",
      "ZCL_E_CAMPAIGN_SEMANTIC_FAILED"
    ],
    "fields": [
      {
        "path": "promptMode",
        "type": "string",
        "required": false,
        "enum": [
          "default",
          "mission_only"
        ],
        "default": "default",
        "description": "Campaign prompt policy: mission_only blocks harness-term leakage and requires auto result-channel finalization."
      },
      {
        "path": "noContext.forbiddenPromptTerms",
        "type": "string[]",
        "required": false,
        "default": [
          "zcl run",
          "zcl mcp proxy",
          "zcl http proxy",
          "zcl feedback",
          "zcl attempt finish",
          "tool.calls.jsonl",
          "feedback.json"
        ],
        "description": "Forbidden mission prompt substrings enforced when promptMode=mission_only."
      },
      {
        "path": "pairGate.traceProfile",
        "type": "string",
        "required": false,
        "enum": [
          "none",
          "strict_browser_comparison",
          "mcp_required"
        ],
        "default": "none",
        "description": "Built-in traceability gate profile applied per attempt in pair-gate evaluation."
      },
      {
        "path": "flows[].runner.toolDriver.kind",
        "type": "string",
        "required": false,
        "enum": [
          "shell",
          "cli_funnel",
          "mcp_proxy",
          "http_proxy"
        ],
        "default": "shell",
        "description": "Flow tool routing contract enforced at campaign parse/lint time."
      },
      {
        "path": "flows[].runner.toolDriver.shims",
        "type": "string[]",
        "required": false,
        "description": "Shim binaries for tool driver funneling. Required (or runner.shims) when promptMode=mission_only with cli_funnel."
      },
      {
        "path": "flows[].runner.finalization.mode",
        "type": "string",
        "required": false,
        "enum": [
          "strict",
          "auto_fail",
          "auto_from_result_json"
        ],
        "default": "auto_fail",
        "description": "Attempt finalization policy. mission_only requires auto_from_result_json."
      },
      {
        "path": "flows[].runner.finalization.resultChannel.kind",
        "type": "string",
        "required": false,
        "enum": [
          "none",
          "file_json",
          "stdout_json"
        ],
        "default": "none",
        "description": "Mission result source used by auto_from_result_json finalization."
      },
      {
        "path": "flows[].runner.finalization.resultChannel.path",
        "type": "string",
        "required": false,
        "default": "mission.result.json",
        "description": "Attempt-relative file path used when resultChannel.kind=file_json."
      },
      {
        "path": "flows[].runner.finalization.resultChannel.marker",
        "type": "string",
        "required": false,
        "default": "ZCL_RESULT_JSON:",
        "description": "Stdout marker prefix used when resultChannel.kind=stdout_json."
      },
      {
        "path": "flows[].runner.finalization.minResultTurn",
        "type": "integer",
        "required": false,
        "default": 1,
        "description": "Minimum mission result payload turn accepted for finalization (supports 3-turn feedback loops)."
      }
    ]
  }
}
